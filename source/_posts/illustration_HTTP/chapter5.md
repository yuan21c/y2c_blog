---
title: 《图解HTTP》第五章 与 HTTP 协作的 web 服务器
date: 2022-09-12 12:56:49
updated: 2022-09-12 12:56:49
categories: 图解HTTP
tags: 
    - web
    - HTTP
    - WWW
description: 
top_img: https://iili.io/66LbYF.jpg
cover: https://iili.io/66LxqB.jpg
---

## 用单台虚拟主机实现多个域名

在相同的 IP 地址下，由于虚拟主机可以寄存多个不同主机名和域名的 Web 网站，因此在发送 HTTP 请求时，必须在 Host 首部内完整指定主机名或域名的 URI 。

## 通信数据转发程序 ：代理、网关、隧道

### 代理

代理是一种有转发功能的应用程序，它扮演了位于服务器和客户端“中间人”的角色，接收由客户端发送的请求并转发给服务器，同时也接收服务器返回的响应并转发给客户端。

代理不会改变请求 URI 。 转发时，需要附加 Via 首部字段以标记出经过的主机信息。

使用代理服务器的理由：

+ 利用缓存技术减少网络带宽的流量；
+ 组织内部针对特定网站的访问控制；
+ 获取访问日志
+ 等等

#### 缓存代理

代理转发响应时，**缓存代理（Caching  Proxy）**会预先将资源的副本（缓存）保存在代理服务器上。

当代理再次接收到对相同资源的请求时，就可以不从源服务器那里获取资源，而是将之前缓存的资源作为响应返回。

#### 透明代理

转发请求或响应时，不对报文做任何加工的代理类型被称为**透明代理（Transparent Proxy）**。反之，对报文内容进行加工的代理被称为**非透明代理**。

### 网关

网关是转发其他服务器通信数据的服务器，接收从客户端发送来的请求时，它就像自己拥有资源的源服务器一样对请求进行处理。有时客户端可能都不会察觉，自己的通信目标是一个网关。

网关能使通信线路上的服务器提供非 HTTP 协议服务。以提高安全性。

### 隧道

隧道是在相隔甚远的客户端和服务器两者之间进行中转，并保持双方通信连接的应用程序。

隧道可按要求建立起一条与其他服务器的通信线路，届时使用 SSL 等加密手段进行通信。隧道的目的是确保客户端能与服务器进行安全的通信。

隧道本身不会去解析 HTTP 请求。也就是说，请求保持原样中转给之后的服务器。隧道会在通信双方断开连接时结束。

## 保存资源的缓存

缓存服务器是代理服务器中的一种，当代理转发从服务器返回的响应时，代理服务器会保存一份资源的副本。

**缓存服务器的优势**在于利用缓存可避免多次从源服务器转发资源。因此客户端可就近从缓存服务器上获取资源，而源服务器也不必多次处理相同的请求了。

### 缓存有效期

即使存在缓存，也会因为**客户端的要求**、**缓存的有效期**等因素，向源服务器确认资源的有效性。若判断缓存失效，缓存服务器将会再次从源服务器上获取“新”资源。

### 客户端的缓存

缓存还可以保存在客户端的浏览器中。

浏览器缓存如果有效，就不必再向服务器请求相同的资源了，可以直接从本地磁盘内读取。

若判断浏览器缓存失效，浏览器会再次请求新资源。

> ## 在 HTTP 出现之前的协议
>
> 在 HTTP 普及之前，也就是从互联网的诞生期至今，曾出现过各式各样的协议。在 HTTP 规范确立之际，制定者们参考了那些协议的功能。也有某些协议现在已经彻底退出了人们的视线。接下来，我们会简单介绍一下这些协议。
>
> + FTP（File Transfer Protocol）
>
>   传输文件时使用的协议。该协议历史久远，可追溯到 1973 年前 后，比 TCP/IP 协议族的出现还要早。虽然它在 1995 年被 HTTP 的流量（Traffic）超越，但时至今日，仍被广泛沿用。
> + NNTP（Network News Transfer Protocol）
>
>   用于 NetNews 电子会议室内传送消息的协议。在 1986 年前后出现，属于比较古老的一类协议。现在，利用 Web 交换信息已成主流，所以该协议已经不怎么使用了。
>
> + Archie
>
>   搜索 anonymous FTP 公开的文件信息的协议。1990 年前后出现，现在已经不常使用。
>
> + WAIS（Wide Area Information Servers）
>
>   以关键词检索多个数据库使用的协议。1991 年前后出现。由于现在已经被 HTTP 协议替代，也已经不怎么使用了。
>
> + Gopher
>
>   查找与互联网连接的计算机内信息的协议。1991 年前后出现，由于现在已经被 HTTP 协议替代，也已经不怎么使用了。
